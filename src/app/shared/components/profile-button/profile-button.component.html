@if (profile(); as profile) {
    <button
        matButton
        aria-label="Profile button"
        cdkOverlayOrigin
        #origin="cdkOverlayOrigin"
        (click)="isOpen.set(!isOpen())"
    >
        <mat-icon [svgIcon]="profile.picture" />
        <span>{{ profile.username }}</span>
    </button>

    <ng-template
        cdkConnectedOverlay
        [cdkConnectedOverlayOrigin]="origin"
        [cdkConnectedOverlayOpen]="isOpen()"
        (overlayOutsideClick)="isOpen.set(false)"
        (detach)="isOpen.set(false)"
    >
        <mat-card appearance="outlined">
            <mat-card-header>
                <mat-card-title>Hello, {{ profile.username }}!</mat-card-title>
            </mat-card-header>

            <mat-card-content>
                <mat-list>
                    <mat-list-item>
                        <span matListItemTitle>E-Mail</span>
                        <span matListItemLine>{{ profile.email }}</span>
                    </mat-list-item>
                </mat-list>
            </mat-card-content>

            <mat-card-actions align="end">
                <a
                    matButton
                    [routerLink]="[`user/${profile.username}`]"
                    (click)="isOpen.set(false)"
                >
                    Profile
                </a>
                <button mat-button (click)="logout()">Logout</button>
            </mat-card-actions>
        </mat-card>
    </ng-template>
} @else {
    @if (small()) {
        <a matIconButton routerLink="auth/login" aria-label="Login">
            <mat-icon>account_circle</mat-icon>
        </a>
    } @else {
        <a matButton="outlined" routerLink="auth/login">Login</a>
    }
}
